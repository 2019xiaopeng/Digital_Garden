# 全局数据存储审计报告

---

## 1) 仍在 localStorage/浏览器侧的数据

| 模块           | 键                     | 用途                                                                 | 位置                                                                 |
|----------------|------------------------|----------------------------------------------------------------------|----------------------------------------------------------------------|
| 设置中心       | eva.settings.v1        | 外观、铃声、dockRoot、AI key 等设置                                 | `settings.ts:17`, `settings.ts:35-45`                               |
| 任务与计划     | qcb.tasks.v1           | 任务离线回退与部分页面同步写入                                     | `dataService.ts:232-335`, `Tasks.tsx:323`                            |
| 首页专项统计   | qcb.attendance.v1      | 首页热力图与专注时长本地回退                                         | `Dashboard.tsx:24`, `Dashboard.tsx:47-326`, `dataService.ts:507`    |
| 每日留痕稿编辑 | eva.blog.draft.v1      | 编辑器草稿暂存                                                       | `Blog.tsx:38`, `Blog.tsx:214-223`                                   |
| AI Key 存储    | eva.ai.api.key         | 历史兼容读取/AI Key 入                                               | `Settings.tsx:20`, `Tasks.tsx:40`, `Tasks.tsx:369`, `Blog.tsx:234`  |
| 知识库树缓存   | evaknowledge-tree      | 左侧树 UI 状态缓存                                                   | `Notes.tsx:35`, `Notes.tsx:81`                                       |
| 知识库文件内容回退 | eva.file:*           | 非 Tauri 回退读取                                                     | `Notes.tsx:146`, `Notes.tsx:769`                                    |
| 资源站视频书签 | eva.video.bookmarks.v1 | 外部视频书签列表                                                     | `Resources.tsx:67`, `Resources.tsx:226-238`                          |

---

## 2) 已落到 Rust 物理文件系统的数据

| 模块           | 目录                                      | 形态                                   | 位置                                                                 |
|----------------|-------------------------------------------|----------------------------------------|----------------------------------------------------------------------|
| 每日留痕       | Documents/EVA_Knowledge_Base/Logs         | 多文件 Markdown（秒级命名）             | `lib.rs:497-625`                                                     |
| 知识库文件     | Documents/EVA_Knowledge_Base/Notes        | 真实文件拷贝、删除、移动、写入         | `lib.rs:1125-1381`, `Notes.tsx:260-428`                              |
| 资源站文件     | Documents/EVA_Knowledge_Base/Resources    | 真实文件拷贝                           | `lib.rs:1264-1317`, `Resources.tsx:96-135`                           |

---

## 3) SQLite（非 localStorage、非文件 markdown）的持久化

| 模块           | 存储           | 位置                                                                 |
|----------------|----------------|----------------------------------------------------------------------|
| 任务、专注会话 | Database/eva.db | `lib.rs:130-337`, `lib.rs:628-684`                                   |

---

## 4) IndexedDB 审计结果

- 当前 src 代码未检出 IndexedDB 读写调用（未发现 indexedDB API 使用）。本次“缓存清理”蓝图可先聚焦 localStorage 键集合与文件系统目录清理。